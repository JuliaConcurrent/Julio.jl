<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Julio</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Julio</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Julio.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/select/">Select</a></li><li><a class="tocitem" href="../../tutorials/happy_eyeballs/">Example: Happy Eyeballs</a></li><li><a class="tocitem" href="../../tutorials/search3/">Example: Google Search 3.0</a></li><li><a class="tocitem" href="../../tutorials/dying_philosopher/">Example: Dying philosopher</a></li><li><a class="tocitem" href="../../tutorials/custom_select/">Advanced: Custom select</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li class="is-active"><a class="tocitem" href>API</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../../explanation/structured_concurrency/">Structured concurrencty</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tkf/Julio.jl/blob/master/docs/src/reference/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Julio.jl is still work-in-progress.</p></div></div><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><ul><li><a href="../../#Julio"><code>Julio</code></a></li><li><a href="#Julio.Events"><code>Julio.Events</code></a></li><li><a href="#Julio.Lock"><code>Julio.Lock</code></a></li><li><a href="#Julio.Promise"><code>Julio.Promise</code></a></li><li><a href="#Julio.cancel!"><code>Julio.cancel!</code></a></li><li><a href="#Julio.channel"><code>Julio.channel</code></a></li><li><a href="#Julio.checkpoint"><code>Julio.checkpoint</code></a></li><li><a href="#Julio.oncancel"><code>Julio.oncancel</code></a></li><li><a href="#Julio.open"><code>Julio.open</code></a></li><li><a href="#Julio.queue"><code>Julio.queue</code></a></li><li><a href="#Julio.select"><code>Julio.select</code></a></li><li><a href="#Julio.shield"><code>Julio.shield</code></a></li><li><a href="#Julio.spawn!"><code>Julio.spawn!</code></a></li><li><a href="#Julio.stack"><code>Julio.stack</code></a></li><li><a href="#Julio.withtaskgroup"><code>Julio.withtaskgroup</code></a></li><li><a href="#Julio.withtimeout"><code>Julio.withtimeout</code></a></li><li><a href="#Julio.yield"><code>Julio.yield</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Julio.Events" href="#Julio.Events"><code>Julio.Events</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Julio.Events.f(args...; kwargs...)</code></pre><p><code>Julio.Events.f(args...; kwargs...)</code> creates an <em>event</em> (i.e., an object describing how to execute <code>f(args...; kwargs...)</code>) that can be passed to <a href="#Julio.select"><code>Julio.select</code></a>.</p><p><strong>Example</strong></p><p>Unlike <code>(f, args...)</code> syntax that is also accepted by <code>Julio.select</code>, <code>Events.f(args...)</code> may have some states. For example, <code>Events.sleep(seconds)</code> sets the timeout at the time the event is created and not when it is passed to <code>Julio.select</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using Julio: Julio, Events

julia&gt; Julio.withtaskgroup() do tg
           Julio.spawn!(tg) do
               ev = Events.sleep(0.1)  # countdown starts now
               while true
                   Julio.select(
                       ev =&gt; Returns(true),  # eventually this event wins
                       Events.sleep(0) =&gt; Returns(false),
                   ) &amp;&amp; break
               end
           end
       end;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.Lock" href="#Julio.Lock"><code>Julio.Lock</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Julio.Lock()</code></pre><p>Creates a reentrant lock.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.Promise" href="#Julio.Promise"><code>Julio.Promise</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Julio.Promise{T}()
Julio.Promise()</code></pre><p>Create a promise.</p><p>A value of type <code>T</code> (or <code>Any</code> if unspecified) can be set once by <code>put!</code>. Calling <code>fetch</code> blocks until <code>put!</code> is called.</p><p>The indexing notation <code>p[]</code> can be used as a synonym for <code>put!</code> and <code>fetch</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Julio

julia&gt; p = Julio.Promise();

julia&gt; p[] = 111;

julia&gt; p[]
111

julia&gt; Julio.withtaskgroup() do tg
           p = Julio.Promise{Int}()
           Julio.spawn!(tg) do
               p[] = 222
           end
           p[]
       end
222</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.cancel!" href="#Julio.cancel!"><code>Julio.cancel!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.cancel!(tg)
Julio.cancel!(scope)
Julio.cancel!(handle)</code></pre><p>Cancel a task group <code>tg</code> or cancellation scope <code>scope</code>.</p><p>It can also be used for revoking the handle returned from <a href="#Julio.oncancel"><code>Julio.oncancel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.channel" href="#Julio.channel"><code>Julio.channel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.channel(T::Type = Any) -&gt; (send_endpoint, receive_endpoint)</code></pre><p><code>Julio.channel</code> creates a unbuffered channel and return a pair of <code>send_endpoint</code> and <code>receive_endpoint</code>.</p><p>Following methods are supported by the channel:</p><pre><code class="language-JULIA hljs">put!(send_endpoint, item::T)
Julio.tryput!(send_endpoint, item::T) -&gt; success::Bool
take!(receive_endpoint) -&gt; item::T
Julio.maybetake!(receive_endpoint) -&gt; Some(item) or nothing
close(send_endpoint)
close(receive_endpoint)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.checkpoint" href="#Julio.checkpoint"><code>Julio.checkpoint</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.checkpoint()</code></pre><p>Check for cancellation signal. It throws when cancellation is required.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.oncancel" href="#Julio.oncancel"><code>Julio.oncancel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.oncancel(f, args...) -&gt; handle</code></pre><p>Register a cancellation callback <code>f</code> and its arguments <code>args</code> to the current cancellation scope.  This callback is triggered via <code>Julio.cancel!(tg)</code> or <code>Julio.cancel!(scope)</code>.</p><p>The registered callback can be removed by <code>Julio.cancel!(handle)</code>.</p><p>See also: <a href="#Julio.cancel!"><code>Julio.cancel!</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Julio

julia&gt; Julio.withtaskgroup() do tg
           Julio.spawn!(tg) do
               ch = Channel()  # non Julio API
               Julio.oncancel(close, ch)  # close the channel on cancellation
               try
                   take!(ch)  # blocks forever
               catch
                   isopen(ch) &amp;&amp; rethrow()  # ignore the exception due to `close`
               end
           end
           Julio.cancel!(tg)
       end;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.open" href="#Julio.open"><code>Julio.open</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.open(io::IO; close = false) -&gt; wrapped_io::IO</code></pre><p>Wrap an IO object into a new IO that is usable via Julio&#39;s synchronization API.</p><pre><code class="nohighlight hljs">Julio.open(x::AbstractCommand, args...)
Julio.open(x::AbstractString, args...)</code></pre><p>Synonym of <code>Julio.open(open(x, args...); close = true)</code>.</p><pre><code class="nohighlight hljs">Julio.open(f, x, args...)</code></pre><p>A shorthand for</p><pre><code class="language-JULIA hljs">resource = Julio.open(x, args...)
try
    f(resource)
finally
    close(resource)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.queue" href="#Julio.queue"><code>Julio.queue</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.queue(T::Type = Any) -&gt; (send_endpoint, receive_endpoint)</code></pre><p>See <a href="#Julio.channel"><code>Julio.channel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.select" href="#Julio.select"><code>Julio.select</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.select(ev₁, ev₂, ..., evₙ) -&gt; ansᵢ</code></pre><p>Select and execute one and only one event <code>evᵢ</code> (<code>1 ≤ i ≤ n</code>) and return its result <code>ansᵢ</code>.</p><p>An even has the following format</p><pre><code class="language-JULIA hljs">(f, args...)
(f, args...) =&gt; g
Julio.Events.f(args...; kwargs...)
Julio.Events.f(args...; kwargs...) =&gt; g</code></pre><p>where <code>f</code> is a function such as <code>take!</code> and <code>put!</code>, <code>args</code> are their arguments, <code>kwargs</code> are the named arguments, and <code>g</code> is a unary function that receives the output of <code>(f, args...)</code> or <code>Julio.Events.f(args...; kwargs...)</code>.  If <code>g</code> is not specified, <code>identity</code> is used instead.</p><p><strong>Examples</strong></p><pre><code class="language-JULIA hljs">using Julio: Events

Julio.select(
    (Julio.tryput!, send_endpoint, item),
    (take!, receive_endpoint) =&gt; item -&gt; begin
        println(&quot;Got: &quot;, item)
    end,
    Event.put!(another_send_endpoint, item),
    Event.readline(io; keep = true) =&gt; line -&gt; begin
        println(&quot;Read line: &quot;, line)
    end,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.shield" href="#Julio.shield"><code>Julio.shield</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.shield(f)</code></pre><p>Run <code>f</code> in a special scope where the cancellation signals are blocked.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.spawn!" href="#Julio.spawn!"><code>Julio.spawn!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.spawn!(f, tg, args...) -&gt; task</code></pre><p>Run a function <code>f</code> with arguments <code>args</code> inside a task managed by the task group <code>tg</code>.</p><p>See <a href="#Julio.withtaskgroup"><code>Julio.withtaskgroup</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Julio

julia&gt; send_endpoint, receive_endpoint = Julio.queue();

julia&gt; Julio.withtaskgroup() do tg
           Julio.spawn!(tg, 111) do x
               put!(send_endpoint, x)
           end
           Julio.spawn!(tg) do
               @show take!(receive_endpoint)
           end
       end;
take!(receive_endpoint) = 111</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.stack" href="#Julio.stack"><code>Julio.stack</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.stack(T::Type = Any) -&gt; (send_endpoint, receive_endpoint)</code></pre><p>See <a href="#Julio.channel"><code>Julio.channel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.withtaskgroup" href="#Julio.withtaskgroup"><code>Julio.withtaskgroup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.withtaskgroup(f) -&gt; ans</code></pre><p>Create a task group <code>tg</code> and pass it to the function <code>f</code> of the form <code>tg -&gt; ans</code>.</p><p>See <a href="#Julio.spawn!"><code>Julio.spawn!</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Julio

julia&gt; Julio.withtaskgroup() do tg
           Julio.spawn!(tg) do
               println(&quot;hello&quot;)
           end
       end;
hello</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.withtimeout" href="#Julio.withtimeout"><code>Julio.withtimeout</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.withtimeout(f, seconds) -&gt; Some(ans) or nothing</code></pre><p>Run <code>f()</code> with timeout <code>seconds</code>.  If it finishes with output value <code>ans</code> before the timeout, return <code>Some(ans)</code>.  Return <code>nothing</code> otherwise.</p><p>Note that blocking operations must use Julio API for automatic cancellation; <code>Julio.sleep</code> instead of <code>sleep</code>, <code>read(Julio.open(io))</code> instead of <code>read(io)</code>, and so on.  Use <code>Julio.</code> Non-Julio API can be cancelled using <a href="#Julio.oncancel"><code>Julio.oncancel</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Julio

julia&gt; Julio.withtimeout(0.1) do
           Julio.sleep(60)
       end === nothing  # too slow
true

julia&gt; Julio.withtimeout(60) do
           Julio.sleep(0.1)
       end === Some(nothing)  # success
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Julio.yield" href="#Julio.yield"><code>Julio.yield</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Julio.yield()</code></pre><p>A shorthand for <code>Julio.checkpoint(); yield()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Julio.jl/blob/07a2c94603609065a9b63e113498a5d44aba2bb2/src/docs.jl#L57-L61">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/custom_select/">« Advanced: Custom select</a><a class="docs-footer-nextpage" href="../../explanation/structured_concurrency/">Structured concurrencty »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Monday 30 August 2021 06:22">Monday 30 August 2021</span>. Using Julia version 1.7.0-beta3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
